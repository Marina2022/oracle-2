import { NextRequest, NextResponse } from 'next/server';

const OPENROUTER_API_KEY = process.env.OPENROUTER_API_KEY;

if (!OPENROUTER_API_KEY) {
  throw new Error('OPENROUTER_API_KEY is not set');
}

export async function POST(request: NextRequest) {
  // Temporary: Return static response as per user example
  const staticResponse = {
    prediction: "ЗЕНИТ",
    confidence: 72,
    sources: [
      "Суперкомпьютер Opta: Зенит 39,6% vs ЦСКА 17,0%",
      "Букмекерские коэффициенты: Зенит 3,10 vs ЦСКА 7,00",
      "Лаборатория CIES: Зенит 36,2%",
      "Текущие позиции и трансферная активность"
    ],
    reasonings: [
      {
        title: "Сравнительный анализ",
        text: "Модель сопоставляет ключевые показатели двух команд: состав, бюджет, трансферы, экспертные оценки"
      },
      {
        title: "Статистическое моделирование",
        text: "Обработка данных всех авторитетных рейтингов показывает устойчивое преимущество «Зенита» по всем параметрам"
      },
      {
        title: "Прогнозирование",
        text: "Взвешенный анализ факторов формирует финальный прогноз в пользу петербургского клуба с уверенностью 72%"
      }
    ],
    detailedAnalysis: "Зенит: лидирует во всех экспертных рейтингах с показателем 39,6% по Opta и 36,2% по CIES. Рекордный трансфер Жерсона за €25 млн. Букмекеры оценивают шансы в 32,2% (коэф. 3,10).\n\nЦСКА: несмотря на текущее лидерство в турнире, получает только 17,0% по Opta и 14,3% у букмекеров (коэф. 7,00). Недостаточные инвестиции в трансферы по сравнению с конкурентами.",
    resume: "Преимущество «Зенита» в долгосрочной перспективе благодаря превосходящему составу, финансовым ресурсам и консенсусу всех аналитических систем"
  };

  return NextResponse.json(staticResponse);
}